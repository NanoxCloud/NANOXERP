/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/var dtAssoc=[],searchResult=[],AutPageNo=1,AutPageSize=50,rcount=0,fetchRCount=FetchPickListRows||1e3;PageCount=0;var CangefldName="",isNavigation=!1,refreshAC=!1,pickarrow=!1,isAutocomBlur=!0,isSelectedValFocus=!1;function createFormSelect(fld){var formSelect=$(fld),fldNameAc="",fieldName="",fastdll="",termVal="",depFldName="",isPickMinChar=!1;formSelect.select2({ajax:{url:"tstruct.aspx/GetAutoCompleteData",type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",delay:250,data:function(e){if(!select2IsOpened||"undefined"!=typeof e.term&&""!=e.term?select2IsFocused?(select2EventType="open",termVal=""==e.term?undefined:isSelectedValFocus?undefined:e.term):"undefined"!=typeof e.term&&""!=e.term&&(termVal=e.term):termVal="",1==(fastdll=$(this).hasClass("fastdll"))||0==fastdll&&""==termVal||0==fastdll&&(void 0===termVal||termVal.length>2)){isPickMinChar=!1;var t=$(this).hasClass("isrefreshsave"),a=GetAutoCompData(fldNameAc,termVal,AutPageNo,AutPageSize),s=fldNameAc.substring(0,fldNameAc.lastIndexOf("F")-3),r="";r="undefined"!=typeof wsPerfEnabled&&wsPerfEnabled?ISBoundAutoCom(s,fldNameAc):ISBoundNew(s,fldNameAc);var l=GetFieldIndex(s),o=FldIsAPI[l];return JSON.stringify({tstDataId:tstDataId,FldName:s,FltValue:termVal,ChangedFields:ChangedFields,ChangedFieldDbRowNo:ChangedFieldDbRowNo,ChangedFieldValues:ChangedFieldValues,DeletedDCRows:DeletedDCRows,pageData:a,fastdll:fastdll,fldNameAc:fldNameAc,refreshAC:refreshAC,pickArrow:pickarrow,parentsFlds:r,rfSave:t,IsApiFld:o})}rcount=0,isPickMinChar=!0},processResults:function processResults(data){select2EventType="open",refreshAC=!1;try{var result=data.d.toString().replace(new RegExp("\\n","g"),"");if(""!=result&&(serverprocesstime=result.split("*♠*")[1],requestProcess_logtime=result.split("*♠*")[2],result=result.split("*♠*")[0],WireElapsTime(serverprocesstime,requestProcess_logtime,!0)),CheckSessionTimeout(result))return;if(result=result.toString().replace(new RegExp("\\t","g"),"&#9;"),ChangedFields=new Array,ChangedFieldDbRowNo=new Array,ChangedFieldValues=new Array,DeletedDCRows=new Array,!result.toLowerCase().includes("access violation")||!result.toLowerCase().includes("asbtstruct.dll")){var serResult=$.parseJSON(result);if(datasss=serResult,serResult.error)return void ExecErrorMsg(serResult.error,"autocomplete");var rcountNew=serResult.pickdata[0].rcount;if(depFldName=serResult.pickdata[2].dfname,0!=rcountNew&&(rcount=parseInt(rcountNew)),rcount=rcount<fetchRCount?rcount:fetchRCount,PageCount=Math.ceil(rcount/AutPageSize),0==PageCount&&(PageCount=1),countPerPage=rcount,1==AutPageNo?1==PageCount?($("#autoleft"+fldNameAc).prop("disabled",!0).addClass("disabled"),$("#autoright"+fldNameAc).prop("disabled",!0).addClass("disabled")):$("#autoright"+fldNameAc).prop("disabled",!1).removeClass("disabled"):AutPageNo>1&&PageCount<=AutPageNo&&$("#autoright"+fldNameAc).prop("disabled",!0).addClass("disabled"),dtAssoc=serResult.pickdata[3].data,dtAssoc!=undefined&&0!=dtAssoc.length){if(fastdll){var aSearch=[];if($(dtAssoc).each(function(e,t){t.i=t.i.replace(/\^\^dq/g,'"'),t.i.toLowerCase().indexOf(termVal.toLowerCase())>=0&&aSearch.push(t)}),$("#"+fldNameAc).data("rowcount",aSearch.length),0!=aSearch.length){var result=$.map(aSearch,function(e){return e.i=e.i.replace(/\^\^dq/g,'"'),{id:e.i,text:e.i,dep:e.d}});return"true"==AxRulesDefFilter&&(result=AxFilterDropDownResult(fldNameAc,result)),searchResult=result,{results:result}}var cutMsg=eval(callParent("lcm[0]"));return{results:"",noResults:cutMsg}}var result=$.map(dtAssoc,function(e){return e.i=e.i.replace(/\^\^dq/g,'"'),{id:e.i,text:e.i,dep:e.d}});return"true"==AxRulesDefFilter&&(result=AxFilterDropDownResult(fldNameAc,result)),searchResult=result,{results:result}}var cutMsg=eval(callParent("lcm[0]"));return{results:"",noResults:cutMsg}}AxWaitCursor(!1),ShowDimmer(!1),$("#reloaddiv").show(),$("#dvlayout").hide()}catch(exception){-1!=exception.message.toLowerCase().indexOf("access violation")&&(AxWaitCursor(!1),ShowDimmer(!1),$("#reloaddiv").show(),$("#dvlayout").hide())}}},placeholder:"Search for a repository",minimumInputLength:0,language:{errorLoading:function(){return isPickMinChar?"Required to search minimum 3 characters":"Start type characters for searching data.."}}}).on("select2:select",function(event){var depList=event.params.data.dep,fldAcValue=$(this).val();if(void 0!==$(this).data("separator")&&fldAcValue.length>1){var separator=$(this).data("separator");fldAcValue=fldAcValue.join(separator)}refreshAC=!1,isGrdEditDirty=!0,dtAssoc=[];var cutMsg=eval(callParent("lcm[0]")),rcID=GetFieldsRowFrameNo(fldNameAc),acFrNo=GetFieldsDcNo(fldNameAc),rowNum=GetDbRowNo(GetFieldsRowNo(fldNameAc),acFrNo),fldRowNo=GetFieldsRowNo(fldNameAc);if(IsDcGrid(acFrNo)&&isGrdEditDirty&&UpdateFieldArray(axpIsRowValid+acFrNo+fldRowNo+"F"+acFrNo,GetDbRowNo(fldRowNo,acFrNo),"","parent","AddRow"),UpdateFieldArray(fldNameAc,rowNum,fldAcValue,"parent","AutoComplete"),depList!=undefined&&null!=depList&&depList!=cutMsg&&""!=depFldName)try{var depText=depList.split("^"),dfCount=0;$.each(depText,function(e,t){var a=depFldName.split("^")[dfCount],s=t;dfCount++,rcID=rcID.substring(0,rcID.lastIndexOf("F")+1)+GetDcNo(a),$("#"+a+rcID).val(s);var r=$j.inArray(a,FNames);"Numeric"==GetFieldType(a,r)&&$("#"+a+rcID).data("attr",s),s!=undefined&&UpdateFieldArray(a+rcID,rowNum,s,"parent","AutoComplete")})}catch(Ex){}setTimeout(function(){MainBlur($j("#"+fldNameAc))},0)}).on("select2:unselect",function(e){var t=$(this).attr("id"),a=$(this).val();if(void 0!==$(this).data("separator")&&a.length>1){var s=$(this).data("separator");a=a.join(s);GetFieldsRowFrameNo(t);var r=GetFieldsDcNo(t),l=GetDbRowNo(GetFieldsRowNo(t),r);UpdateFieldArray(t,l,a,"parent","AutoComplete")}setTimeout(function(){MainBlur($j("#"+t))},0)}).on("select2:open",function(e){isPickMinChar=!1,select2IsFocused?(select2EventType="tab",""!=$(this).val()&&($("input.select2-search__field").val($(this).val()),isSelectedValFocus=!0)):($(this).attr("id")!=AxFocusedFld&&""!=AxFocusedFld&&MainBlur($("#"+AxFocusedFld)),select2IsOpened=!0,select2EventType="click");var t=void 0===$(this).attr("data-addoption")?"":$(this).attr("data-addoption"),a=void 0===$(this).attr("data-refresh")?"":$(this).attr("data-refresh"),s=$(this).attr("id"),r="";void 0!==a&&""!=a&&"true"==a?r+='<a class="btn btn-sm btn-icon btn-white btn-color-gray-500 btn-active-primary me-2 shadow-sm ms-2 fsautorefresh" id="autorefresh'+s+'" title="Refresh" data-refresh='+s+'><span class="material-icons material-icons-style material-icons-3">refresh</span></a>':void 0!==a&&""!=a&&"false"==a&&(r+='<a class="btn btn-sm btn-icon btn-white btn-color-gray-500 btn-active-primary me-2 shadow-sm ms-2 disabled" id="autoleft'+s+'" title="Previous" data-fldname='+s+'><span class="material-icons material-icons-style material-icons-3">navigate_before</span></a><a class="btn btn-sm btn-icon btn-white btn-color-gray-500 btn-active-primary me-2 shadow-sm disabled" id="autoright'+s+'" title="Next" data-fldname='+s+'><span class="material-icons material-icons-style material-icons-3">navigate_next</span></a><a class="btn btn-sm btn-icon btn-white btn-color-gray-500 btn-active-primary me-2 shadow-sm float-end" id="advSearch'+s+'" title="adv. search" data-ids='+s+'><span class="material-icons material-icons-style material-icons-3">search</span></a><input type=hidden id="pickIdVal_'+s+'" value="" />'),void 0!==t&&""!=t&&(r+='<a class="btn btn-sm btn-icon btn-white btn-color-gray-500 btn-active-primary me-2 shadow-sm float-end" id="addOption'+s+'" data-ids='+s+' title="Add Master Data"><span class="material-icons material-icons-style material-icons-3">add</span></a>'),$(".select2-results:not(:has(a))").append(r),fldNameAc=$(this).attr("id"),CangefldName!=fldNameAc&&(AutPageNo=1,rcount=0,CangefldName=fldNameAc),isNavigation||(AutPageNo=1),isNavigation=!1,clickEvents(s)}).on("select2:close",function(e){isSelectedValFocus=!1})}function clickEvents(e){$(document).off("click","#autorefresh"+e),$(document).on("click","#autorefresh"+e,function(){refreshAC=!0,AutPageNo=1,rcount=0,CangefldName="",PageCount=0,isSelectedValFocus=!1,select2IsOpened=!0,select2EventType="click",$(".select2-dropdown--below").find(".select2-search__field").trigger($.Event("input",{which:13}))}),$(document).off("click","#autoleft"+e),$(document).on("click","#autoleft"+e,function(){isNavigation=!0,pickarrow=!0,AutPageNo--,isSelectedValFocus=!1,$("#autoright"+e).prop("disabled",!1).removeClass("disabled"),1==AutPageNo&&$("#autoleft"+e).prop("disabled",!0).addClass("disabled"),select2IsOpened=!0,select2EventType="click",$(".select2-dropdown--below").find(".select2-search__field").trigger($.Event("input",{which:13}))}),$(document).off("click","#autoright"+e),$(document).on("click","#autoright"+e,function(){isNavigation=!0,pickarrow=!0,AutPageNo++,isSelectedValFocus=!1,$("#autoleft"+e).prop("disabled",!1).removeClass("disabled"),PageCount<=AutPageNo&&$("#autoright"+e).prop("disabled",!0).addClass("disabled"),select2IsOpened=!0,select2EventType="click",$(".select2-dropdown--below").find(".select2-search__field").trigger($.Event("input",{which:13}))}),$(document).off("click","#advSearch"+e),$(document).on("click","#advSearch"+e,function(){$("#"+$(this).data("ids")).select2("close"),isSelectedValFocus=!1,SearchOpenNew($(this).data("ids"))}),$(document).off("click","#addOption"+e),$(document).on("click","#addOption"+e,function(){$("#"+$(this).data("ids")).select2("close");var e=$(this).data("ids"),t=$("#"+e).data("addoption"),a=e.substring(0,e.lastIndexOf("F")-3),s="tstruct.aspx?transid="+t.split("~")[0]+"&AxPop=true&AxRefSelect=true&AxRefSelectID="+a+"&AxSrcSelectID="+t.split("~")[1]+"&AxRefType="+t.split("~")[2];isSelectedValFocus=!1;var r=new BSModal("modalIdNewItem","","<iframe class='col-12 h-100' src='"+s+"'></iframe>",function(){},function(){});r.changeSize("fullscreen"),r.hideFooter(),r.hideHeader(),r.showFloatingClose()}),$(document).off("keydown","input.select2-search__field"),$(document).on("keydown","input.select2-search__field",function(e){isSelectedValFocus&&(isSelectedValFocus=!1)}),$(document).off("keypress","input.select2-search__field"),$(document).on("keypress","input.select2-search__field",function(e){isSelectedValFocus&&(isSelectedValFocus=!1)})}function GetAutoCompData(e,t,a,s){var r="";if(arrRefreshDcs.length>0)for(var l=0;l<arrRefreshDcs.length;l++){var o=arrRefreshDcs[l].split(":");r=o[1].replace("dc","")+","+o[0].replace("dc","")}t=CheckSpecialCharsInStr(t);var i=GetFieldsDcNo(e);AxActiveRowNo=parseInt(GetFieldsRowNo(e),10),AxActiveRowNo=GetDbRowNo(AxActiveRowNo,i);var d=AxActiveRowNo,c="";""!=AxActivePRow&&""!=AxActivePDc&&(c=AxActivePDc+"♠"+AxActivePRow);var n="";return IsParentField(e,i)&&(n=GetSubGridInfoForParent(i,AxActiveRowNo)),a.toString()+"~"+s.toString()+"~"+i+"~"+d+"~"+c+"~"+n+"~"+r}function createFormMultiSelect(msfldId){var formSelect=$(msfldId),msData="",refreshMs=!1,fldNameMs="",isrefreshsave="",fieldName="",pageData="",parentFldVal="";formSelect.select2({ajax:{url:"tstruct.aspx/GetMultiSelectValues",type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",delay:250,data:function(e){return!select2IsOpened||"undefined"!=typeof e.term&&""!=e.term?select2IsFocused?(select2EventType="open",termVal=""==e.term?undefined:e.term):"undefined"!=typeof e.term&&""!=e.term&&(termVal=e.term):termVal="",fldNameMs=$(this).attr("id"),isrefreshsave=$(this).hasClass("isrefreshsave"),fieldName=fldNameMs.substring(0,fldNameMs.lastIndexOf("F")-3),pageData=GetMultiSelectPageData(fldNameMs,"",1,AutPageSize),JSON.stringify({tstDataId:tstDataId,FldName:fieldName,ChangedFields:ChangedFields,ChangedFieldDbRowNo:ChangedFieldDbRowNo,ChangedFieldValues:ChangedFieldValues,DeletedDCRows:DeletedDCRows,fldNameMs:fldNameMs,refreshMs:refreshMs,parentsFlds:parentFldVal,rfSave:isrefreshsave,pageData:pageData})},processResults:function processResults(data){select2EventType="open";var result=data.d.toString().replace(new RegExp("\\n","g"),"");if(!CheckSessionTimeout(result)&&(result=result.toString().replace(new RegExp("\\t","g"),"&#9;"),ChangedFields=new Array,ChangedFieldDbRowNo=new Array,ChangedFieldValues=new Array,DeletedDCRows=new Array,-1===result.toLowerCase().indexOf("access violation"))){var serResult=$.parseJSON(result);if(serResult.error)return void ExecErrorMsg(serResult.error,"autocomplete");if(msData=serResult.multiselectdata[3].data,0!=msData.length){msData=_.sortBy(msData,"grouporder");var grdNo=0,mulResult="[",result=$.map(msData,function(e){0==grdNo?(grdNo=e.grouporder,mulResult+='{"id":"'+e.grouporder+'","text":"'+e.groupby+'","children":[{"id":"'+e.mslist+'","text":"'+e.mslist+'","selected":"'+e.selected+'"}'):grdNo==e.grouporder?(grdNo=e.grouporder,mulResult+=',{"id":"'+e.mslist+'","text":"'+e.mslist+'","selected":"'+e.selected+'"}'):grdNo!=e.grouporder&&(grdNo=e.grouporder,mulResult+=']},{"id":"'+e.grouporder+'","text":"'+e.groupby+'","children":[{"id":"'+e.mslist+'","text":"'+e.mslist+'", "selected":"'+e.selected+'"}')});return"["!=mulResult?mulResult+="]}]":"["==mulResult&&(mulResult=""),{results:$.parseJSON(mulResult)}}var cutMsg=eval(callParent("lcm[0]")),result=[{id:"NO1234567890",text:cutMsg,dep:cutMsg}];return searchResult=result,{results:result}}}},tags:"true",placeholder:"Search for a repository",minimumInputLength:0}).on("select2:select",function(e){var t=$(this).val();if(void 0!==$(this).data("sep")&&t.length>1){var a=$(this).data("sep");t=t.join(a)}var s=GetFieldsDcNo(fldNameMs),r=GetDbRowNo(GetFieldsRowNo(fldNameMs),s);$(this).attr("data-selected",t),UpdateFieldArray(fldNameMs,r,t,"parent","AutoComplete")}).on("select2:unselect",function(e){var t=$(this).attr("id"),a=$(this).val();if(void 0!==$(this).data("sep")&&a.length>1){var s=$(this).data("sep");a=a.join(s);var r=GetFieldsDcNo(t),l=GetDbRowNo(GetFieldsRowNo(t),r);$(this).attr("data-selected",a),UpdateFieldArray(t,l,a,"parent","AutoComplete")}}).on("select2:open",function(e){select2IsFocused?select2EventType="tab":(select2IsOpened=!0,select2EventType="click")})}function GetMultiSelectPageData(e,t,a,s){var r="";if(arrRefreshDcs.length>0)for(var l=0;l<arrRefreshDcs.length;l++){var o=arrRefreshDcs[l].split(":");r=o[1].replace("dc","")+","+o[0].replace("dc","")}t=CheckSpecialCharsInStr(t);var i=GetFieldsDcNo(e);AxActiveRowNo=parseInt(GetFieldsRowNo(e),10),AxActiveRowNo=GetDbRowNo(AxActiveRowNo,i);var d=AxActiveRowNo,c="";""!=AxActivePRow&&""!=AxActivePDc&&(c=AxActivePDc+"♠"+AxActivePRow);var n="";return IsParentField(e,i)&&(n=GetSubGridInfoForParent(i,AxActiveRowNo)),a.toString()+"~"+s.toString()+"~"+i+"~"+d+"~"+c+"~"+n+"~"+r}function AxGetCustSelectFldData(e){var t="",a=$("#"+e).hasClass("fastdll"),s=GetAutoCompData(e,"",1,1e3),r=e.substring(0,e.lastIndexOf("F")-3),l="";l="undefined"!=typeof wsPerfEnabled&&wsPerfEnabled?ISBoundAutoCom(r,e):ISBoundNew(r,e);var o=GetFieldIndex(r),i=FldIsAPI[o];return $.ajax({url:"tstruct.aspx/GetAutoCompleteData",type:"POST",cache:!1,async:!1,data:JSON.stringify({tstDataId:tstDataId,FldName:r,FltValue:"",ChangedFields:ChangedFields,ChangedFieldDbRowNo:ChangedFieldDbRowNo,ChangedFieldValues:ChangedFieldValues,DeletedDCRows:DeletedDCRows,pageData:s,fastdll:a,fldNameAc:e,refreshAC:!1,pickArrow:!1,parentsFlds:l,rfSave:!0,IsApiFld:i}),dataType:"json",contentType:"application/json",success:function(e){try{var a=e.d.toString().replace(new RegExp("\\n","g"),"");if(""!=a&&(a=a.split("*♠*")[0]),CheckSessionTimeout(a))return;a=a.toString().replace(new RegExp("\\t","g"),"&#9;"),ChangedFields=new Array,ChangedFieldDbRowNo=new Array,ChangedFieldValues=new Array,DeletedDCRows=new Array,a.toLowerCase().includes("access violation")&&a.toLowerCase().includes("asbtstruct.dll")?(AxWaitCursor(!1),ShowDimmer(!1),showAlertDialog("error","Access Violation")):t=a}catch(s){AxWaitCursor(!1),ShowDimmer(!1),showAlertDialog("error",s.message)}},error:function(e){AxWaitCursor(!1),ShowDimmer(!1),showAlertDialog("error",e)}}),t}$(function(){createFormSelect(".fldFromSelect,.multiFldChk"),createFormMultiSelect(".fldmultiSelect")});