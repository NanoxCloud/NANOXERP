/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/var fldAutoData=[],fldAutoList="",fldExpData=[],colNames=[],colVExp=[],colfExp=[],aportionWhat=[],aportionAgainst=[],aportionWhatVal=[],sqlQuery="";function LoadTableEvents(dvId){var autoDiv=dvId==undefined?"#divDc1":dvId;$j(dvId).find(".tblFromSelect:not(span)").select2(),createFormSelect(dvId+" .tblFromSelect:not(span)");var glType=eval(callParent("gllangType")),dtpkrRTL=!1;dtpkrRTL="ar"==glType;var glCulture=eval(callParent("glCulture")),dtFormat="dd/mm/yy";"en-us"==glCulture&&(dtFormat="mm/dd/yy"),$(".flatpickr-input").flatpickr({dateFormat:dtFormat}),$j(dvId+" .number").unbind("keypress"),$j(".number").keypress(function(e){return CheckNumeric(e,$j(this).val())}),$j("input.number").on("input",function(){var e=$j(this).val(),a=$j(this).attr("id"),t=$j(this).attr("data-fInd");if(a!=undefined){var l=callParentNew("FMaxLength")[t],n=callParentNew("FDecimal")[t];if(n!=undefined&&n>0){var r=l-n-1;if(-1==e.indexOf("."))e.length>r&&$j(this).val(e.slice(0,r));else if(-1!=e.indexOf(".")){var s=e.substring(0,e.indexOf(".")),i=e.substring(e.indexOf(".")+1,e.length);s.length>r&&(s=s.slice(0,r)),i.length>n&&(i=i.slice(0,n)),$j(this).val(s+"."+i)}}}}),$j(":text").unbind("blur"),$j(":text").blur(function(e){MainBlur($j(this),"input")}),$j("select").unbind("change"),$j("select").change(function(){MainBlur($j(this),"select")})}$j(document).ready(function(){GetTableHtml(),$j(":text").blur(function(e){MainBlur($j(this),"input")}),$j("select").change(function(){MainBlur($j(this),"select")}),LoadTableEvents("#divTable")});var dtAssoc=[],searchResult=[],AutPageNo=1,AutPageSize=50,rcount=0,fetchRCount=callParentNew("FetchPickListRows")||1e3;PageCount=0;var CangefldName="",isNavigation=!1,refreshAC=!1,pickarrow=!1;function createFormSelect(fld){var formSelect=$(fld),fldNameAc="",fieldName="",fastdll="",termVal="",depFldName="";formSelect.select2({ajax:{url:"tstruct.aspx/GetAutoCompleteData",type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",delay:250,data:function(e){termVal=e.term==undefined?"":e.term;var a=$(this).attr("data-id");fastdll=$(a).hasClass("fastdll");var t=$(a).hasClass("isrefreshsave"),l=GetAutoCompData(fldNameAc,termVal,AutPageNo,AutPageSize),n=fldNameAc.substring(0,fldNameAc.lastIndexOf("F")-3),r="";r="undefined"!=typeof wsPerfEnabled&&wsPerfEnabled?callParentNew("ISBoundAutoCom("+n+","+fldNameAc+")","function"):callParentNew("ISBoundNew("+n+","+fldNameAc+")","function");var s=callParentNew("GetFieldIndex("+n+")","function"),i=callParentNew("FldIsAPI")[s];return JSON.stringify({tstDataId:callParentNew("tstDataId"),FldName:n,FltValue:termVal,ChangedFields:ChangedFields,ChangedFieldDbRowNo:ChangedFieldDbRowNo,ChangedFieldValues:ChangedFieldValues,DeletedDCRows:DeletedDCRows,pageData:l,fastdll:fastdll,fldNameAc:fldNameAc,refreshAC:refreshAC,pickArrow:pickarrow,parentsFlds:r,rfSave:t,IsApiFld:i})},processResults:function processResults(data){refreshAC=!1;try{var result=data.d.toString().replace(new RegExp("\\n","g"),"");if(""!=result&&(serverprocesstime=result.split("*♠*")[1],requestProcess_logtime=result.split("*♠*")[2],result=result.split("*♠*")[0]),result=result.toString().replace(new RegExp("\\t","g"),"&#9;"),ChangedFields=new Array,ChangedFieldDbRowNo=new Array,ChangedFieldValues=new Array,DeletedDCRows=new Array,!result.toLowerCase().includes("access violation")||!result.toLowerCase().includes("asbtstruct.dll")){var serResult=$.parseJSON(result);if(datasss=serResult,serResult.error)return void ExecErrorMsg(serResult.error,"autocomplete");if(dtAssoc=serResult.pickdata[3].data,dtAssoc!=undefined&&0!=dtAssoc.length){if(fastdll){var aSearch=[];if($(dtAssoc).each(function(e,a){a.i=a.i.replace(/\^\^dq/g,'"'),a.i.toLowerCase().indexOf(termVal.toLowerCase())>=0&&aSearch.push(a)}),$("#"+fldNameAc).data("rowcount",aSearch.length),0!=aSearch.length){var result=$.map(aSearch,function(e){return e.i=e.i.replace(/\^\^dq/g,'"'),{id:""==e.v?e.i:e.v,text:e.i,dep:e.d}});return searchResult=result,{results:result}}var cutMsg=eval(callParent("lcm[0]"));return{results:"",noResults:cutMsg}}var result=$.map(dtAssoc,function(e){return e.i=e.i.replace(/\^\^dq/g,'"'),{id:""==e.v?e.i:e.v,text:e.i,dep:e.d}});return searchResult=result,{results:result}}var cutMsg=eval(callParent("lcm[0]"));return{results:"",noResults:cutMsg}}AxWaitCursor(!1),ShowDimmer(!1),$("#reloaddiv").show(),$("#dvlayout").hide()}catch(exception){-1!=exception.message.toLowerCase().indexOf("access violation")&&(AxWaitCursor(!1),ShowDimmer(!1),$("#reloaddiv").show(),$("#dvlayout").hide())}}},placeholder:"Search for a repository",minimumInputLength:0}).on("select2:open",function(e){var a=$(this).attr("data-id");fldNameAc=a})}function GetTableHtml(){var e="";try{parent.ChangedTblFields=new Array,parent.ChangedTblFieldVals=new Array;var a=$("#hdnfieldId").val(),t=$(callParentNew(a,"id")).val(),l=$(callParentNew(a,"id")).prop("disabled"),n=callParentNew("GetFieldsRowNo("+a+")","function"),r=a.substring(0,a.lastIndexOf("F")-3),s=callParentNew("GetFieldIndex("+r+")","function"),i=callParentNew("FTableTypeVal")[s];if(""!=i){if(!(i=RepSpecialCharsInHTML(i)).startsWith("{")){var o=i.split("~")[1],c=callParentNew("GetDcNo("+o+")","function");i=GetstrTableJson("True"==parent.DCIsGrid[c-1]?$(callParentNew(o+n+"F"+c,"id")).val():$(callParentNew(o+"000F"+c,"id")).val())}var d=JSON.parse(i);if(void 0!==d){var p=d.props.type,u=d.props.colcount,f=d.props.rowcount,v=d.props.deleterow,m=d.props.addrow,h=d.props.rowseparator,b=d.props.valueseparator;"undefined"!=typeof d.props.sql&&(sqlQuery=d.props.sql);var g=1==l?"disabled":"";if("table"==p){var w="";""!=t&&(w=t.split(h)).length>f&&(f=w.length),""==w&&""!=sqlQuery&&SqlFillData();var N="",y="";N+='<tr class="fw-bold fs-6 text-gray-800 border-bottom-2 border-gray-200">',"t"!=v.toLowerCase()&&"true"!=v.toLowerCase()||(N+='<th class="w-10px"></th>');for(var x=0;x<u;x++){var F=d.columns[x+1].caption;colNames.push(d.columns[x+1].name),parent.ChangedTblFields.push(d.columns[x+1].name),parent.ChangedTblFieldVals.push(""),N+="<th>"+F+"</th>";var C=d.columns[x+1].exp;colfExp.push(C);var P="";if(""!=C&&(C=C.replace(/,/g,"♦"),P=callParentNew("Evaluate("+d.columns[x+1].name+",000,"+C+",expr,table)","function")),fldExpData.push(P),colVExp.push(d.columns[x+1].vexp),"undefined"!=typeof d.columns[x+1].aportionwhat&&""!=d.columns[x+1].aportionwhat){aportionWhat.push(d.columns[x+1].aportionwhat);var j=d.columns[x+1].aportionwhat,I=$j($j("[id*='"+j+"']",doParentOpInIframe("document","rtn","[id*='"+j+"']")).find("input")).attr("id");aportionWhatVal.push($(callParentNew(I,"id")).val())}else aportionWhat.push(""),aportionWhatVal.push("");"undefined"!=typeof d.columns[x+1].aportionagainst?aportionAgainst.push(d.columns[x+1].aportionagainst):aportionAgainst.push("")}N+="</tr>";for(var A=0;A<f;A++){var T="";"undefined"!=typeof w[A]&&""!=w[A]&&""!=w&&(T=(T=w[A]).split(b)),y+="<tr id="+A+">","t"!=v.toLowerCase()&&"true"!=v.toLowerCase()||(y+='<td class="input-group-sm"><div class="form-check form-check-sm form-check-custom form-check-solid p-2"><input type="checkbox" class="form-check-input fgChk" name="chkItem" onclick="javascript:ChkHdrCheckbox(this);" '+g+"></div></td>");var D=function(){var e="";e="undefined"!=typeof T[x]&&""!=T[x]&&""!=T?T[x]:"undefined"!=typeof fldExpData[x]&&""!=fldExpData[x]?fldExpData[x]:"undefined"!=typeof aportionWhatVal[x]&&""!=aportionWhatVal[x]&&0==A?aportionWhatVal[x]:d.columns[x+1].value;var a=d.columns[x+1].source,t=callParentNew("GetFieldIndex("+a+")","function"),l=(callParentNew("GetDWBFieldType('',"+t+")","function"),callParentNew("GetDcNo("+a+")","function")),r=a+n+"F"+l;if("Select"==callParentNew("FMoe")[t])if("True"==callParentNew("FldIsSql")[t])y+='<td class="input-group-sm"><select '+g+' class="combotem Family form-control form-select tblFromSelect fldtableinput" data-control="select2" name="'+colNames[x]+'" id="'+(colNames[x]+A)+'" value="'+e+'" data-id="'+r+'" data-placeholder="Select an option" data-allow-clear="true">',""!=e&&(y+='<option value="'+e+'" selected="selected">'+e+"</option>"),y+="</select></td>";else if(k="",$(callParentNew(r)).find("option").each(function(){""!=e&&$(this)[0].value==e?k+=$(this)[0].outerHTML.replace("<option ","<option selected "):k+=$(this)[0].outerHTML.replace('selected="selected"',"")}),""==k){var s=$(callParentNew(r)).data("val").split(","),i=""==$(callParentNew(r)).val()?e:$(callParentNew(r)).val();for(O=0;O<s.length;O++)""!=i&&i==s[O]?k+='<option selected="selected" value="'+s[O]+'">'+(""==s[O]?"-- Select --":s[O])+"</option>":k+='<option value="'+s[O]+'">'+(""==s[O]?"-- Select --":s[O])+"</option>";y+='<td class="input-group-sm"><select '+g+' class="tem Family form-control" name="'+colNames[x]+'" id="'+(colNames[x]+A)+'" value="'+i+'">'+k+"</select></td>"}else y+='<td class="input-group-sm"><select '+g+' class="tem Family form-control" name="'+colNames[x]+'" id="'+(colNames[x]+A)+'" value="'+e+'">'+k+"</select></td>";else if("Accept"==callParentNew("FMoe")[t]&&"True"==callParentNew("FldIsSql")[t])y+='<td class="input-group-sm"><input '+g+' type="text" class="tem Family form-control fldtableinput" name="'+colNames[x]+'" id="'+(colNames[x]+A)+'" value="'+e+'"></td>';else if("undefined"!=typeof aportionWhat[x]&&""!=aportionWhat[x])y+='<td class="input-group-sm"><input '+g+' type="text" class="tem Family form-control fldtableinput" readonly name="'+colNames[x]+'" id="'+(colNames[x]+A)+'" value="'+e+'"></td>';else if("Numeric"==callParentNew("FDataType")[t])y+='<td class="input-group-sm"><input '+g+' type="text" style="text-align:right;" class="tem Family form-control number fldtableinput" data-fInd="'+t+'" name="'+colNames[x]+'" id="'+(colNames[x]+A)+'" value="'+e+'"></td>';else if("Date/Time"==callParentNew("FDataType")[t])y+='<td class="input-group-sm"><input '+g+' type="text" class="tem Family form-control flatpickr-input fldtableinput" name="'+colNames[x]+'" id="'+(colNames[x]+A)+'" value="'+e+'">',y+='<span class="input-group-addon spandate "><i class="glyphicon glyphicon-calendar icon-basic-calendar" title='+colNames[x]+"></i></span></td>";else if(""!=a&&"Accept"==callParentNew("FMoe")[t]&&""!=$(callParentNew(r)).val()&&$(callParentNew(r)).val().indexOf(",")>0){var o=$(callParentNew(r)).val().split(","),c=e;for(k="",k+='<option value="">-- Select --</option>',O=0;O<o.length;O++)""!=c&&c==o[O]?k+='<option selected="selected" value="'+o[O]+'">'+o[O]+"</option>":k+='<option value="'+o[O]+'">'+o[O]+"</option>";y+='<td class="input-group-sm"><select '+g+' class="tem Family form-control" name="'+colNames[x]+'" id="'+(colNames[x]+A)+'" value="'+c+'">'+k+"</select></td>"}else y+='<td class="input-group-sm"><input '+g+' type="text" class="tem Family form-control fldtableinput" name="'+colNames[x]+'" id="'+(colNames[x]+A)+'" value="'+e+'"></td>';parent.ChangedTblFieldVals[x]=0==A?e:parent.ChangedTblFieldVals[x]+"~"+e};for(x=0;x<u;x++){D()}y+="</tr>"}e='<div class="container p-0">',e+='<div class="col-12 pb-5">',"t"!=m.toLowerCase()&&"true"!=m.toLowerCase()||(e+='<div class="btn btn-sm btn-icon btn-white btn-color-gray-500 btn-active-primary me-2 shadow-sm pull-left '+g+'"><span class="material-icons material-icons-style material-icons-3" title="Add" onclick="AddTableRows(\'fldTable\');">add</span></div>'),"t"!=v.toLowerCase()&&"true"!=v.toLowerCase()||(e+='<div class="btn btn-sm btn-icon btn-white btn-color-gray-500 btn-active-primary me-2 shadow-sm pull-left '+g+'"><span class="material-icons material-icons-style material-icons-3" title="Delete" onclick="DeleteTableRows(\'fldTable\');">delete_outline</span></div>'),""!=sqlQuery&&(e+='<div class="btn btn-sm btn-icon btn-white btn-color-gray-500 btn-active-primary me-2 shadow-sm pull-left '+g+'"><span class="material-icons material-icons-style material-icons-3" title="Fill Data" onclick="SqlFillData();">view_list</span></div>'),e+='<table id="fldTable" class="table table-bordered table-sm mt-10">',e+="<thead>",e+=N,e+="</thead>",e+="<tbody>",e+=y,e+="</tbody>",e+="</table>",e+="</div>",e+="<div></div>",e+='<div class="float-end"><a href="javascript:void(0)" onclick="ClearTableData(\'fldTable\');" class="btn btn-white btn-color-gray-700 btn-active-primary d-inline-flex align-items-center shadow-sm me-2 '+g+'"><span class="material-icons">clear</span>Clear</a><a href="javascript:void(0);" title="Ok" onclick="AddTableData(\''+a+"','"+b+"','"+h+'\');" class="btn btn-primary d-inline-flex align-items-center shadow-sm me-2 '+g+'"><span class="material-icons">save</span>Ok</a></div>',e+="</div>"}else{var S="";""!=t&&(S=(S=t).split(b));var V='<div id="divtblForm" >',R=function(){var e=d.columns[x+1].caption;V+='<div class="col-lg-12 col-sm-3 col-md-3 col-xs-12"><label>'+e+"</label></div>",V+='<div class="col-lg-12 col-sm-9 col-md-9 col-xs-12">',colNames.push(d.columns[x+1].name),parent.ChangedTblFields.push(d.columns[x+1].name),parent.ChangedTblFieldVals.push("");var a=d.columns[x+1].exp;if(colfExp.push(a),P="",""!=a&&(a=a.replace(/,/g,"♦"),P=callParentNew("Evaluate("+d.columns[x+1].name+",000,"+a+",expr,table)","function")),fldExpData.push(P),colVExp.push(d.columns[x+1].vexp),"undefined"!=typeof d.columns[x+1].aportionwhat&&""!=d.columns[x+1].aportionwhat){aportionWhat.push(d.columns[x+1].aportionwhat);var t=d.columns[x+1].aportionwhat;I=$j($j("[id*='"+t+"']",doParentOpInIframe("document","rtn","[id*='"+t+"']")).find("input")).attr("id"),aportionWhatVal.push($(callParentNew(I,"id")).val())}else aportionWhat.push(""),aportionWhatVal.push("");"undefined"!=typeof d.columns[x+1].aportionagainst?aportionAgainst.push(d.columns[x+1].aportionagainst):aportionAgainst.push("");var l="";l="undefined"!=typeof S[x]&&""!=S[x]&&""!=S?S[x]:"undefined"!=typeof fldExpData[x]&&""!=fldExpData[x]?fldExpData[x]:"undefined"!=typeof aportionWhatVal[x]&&""!=aportionWhatVal[x]?aportionWhatVal[x]:d.columns[x+1].value;var r=d.columns[x+1].source,s=callParentNew("GetFieldIndex("+r+")","function"),i=(callParentNew("GetDWBFieldType('',"+s+")","function"),callParentNew("GetDcNo("+r+")","function")),o=r+n+"F"+i;if("Select"==callParentNew("FMoe")[s])if("True"==callParentNew("FldIsSql")[s])tdRow+='<td class="input-group-sm"><select '+g+' class="combotem Family form-control form-select tblFromSelect fldtableinput" data-control="select2" name="'+colNames[x]+'" id="'+(colNames[x]+0)+'" value="'+l+'" data-id="'+o+'" data-placeholder="Select an option" data-allow-clear="true">',""!=l&&(tdRow+='<option value="'+l+'" selected="selected">'+l+"</option>"),tdRow+="</select></td>";else if(k="",$(callParentNew(o)).find("option").each(function(){""!=l&&$(this)[0].value==l?k+=$(this)[0].outerHTML.replace("<option ","<option selected "):k+=$(this)[0].outerHTML.replace('selected="selected"',"")}),""==k){var c=$(callParentNew(o)).data("val").split(","),p=""==$(callParentNew(o)).val()?l:$(callParentNew(o)).val();for(O=0;O<c.length;O++)""!=p&&p==c[O]?k+='<option selected="selected" value="'+c[O]+'">'+(""==c[O]?"-- Select --":c[O])+"</option>":k+='<option value="'+c[O]+'">'+(""==c[O]?"-- Select --":c[O])+"</option>";V+="<select "+g+' class="tem Family form-control" name="'+colNames[x]+'" id="'+(colNames[x]+0)+'" value="'+p+'">'+k+"</select>"}else V+="<select "+g+' class="tem Family form-control" name="'+colNames[x]+'" id="'+(colNames[x]+0)+'" value="'+l+'">'+k+"</select>";else if("Accept"==callParentNew("FMoe")[s]&&"True"==callParentNew("FldIsSql")[s])V+="<input "+g+' type="text" class="tem Family form-control fldtableinput" name="'+colNames[x]+'" id="'+(colNames[x]+0)+'" value="'+l+'">';else if("undefined"!=typeof aportionWhat[x]&&""!=aportionWhat[x])V+="<input "+g+' type="text" class="tem Family form-control fldtableinput" readonly name="'+colNames[x]+'" id="'+(colNames[x]+0)+'" value="'+l+'">';else if("Numeric"==callParentNew("FDataType")[s])V+="<input "+g+' type="text" style="text-align:right;" class="tem Family form-control number fldtableinput" data-fInd="'+s+'" name="'+colNames[x]+'" id="'+(colNames[x]+0)+'" value="'+l+'">';else if("Date/Time"==callParentNew("FDataType")[s])V+='<div class="input-group"><input '+g+' type="text" class="tem Family form-control flatpickr-input fldtableinput" name="'+colNames[x]+'" id="'+(colNames[x]+0)+'" value="'+l+'">',V+='<span class="input-group-addon spandate "><i class="glyphicon glyphicon-calendar icon-basic-calendar" title="'+colNames[x]+'"></i></span></div>';else if(""!=r&&"Accept"==callParentNew("FMoe")[s]&&""!=$(callParentNew(o)).val()&&$(callParentNew(o)).val().indexOf(",")>0){var u=$(callParentNew(o)).val().split(","),f=l;for(k="",k+='<option value="">-- Select --</option>',O=0;O<u.length;O++)""!=f&&f==u[O]?k+='<option selected="selected" value="'+u[O]+'">'+u[O]+"</option>":k+='<option value="'+u[O]+'">'+u[O]+"</option>";V+="<select "+g+' class="tem Family form-control" name="'+colNames[x]+'" id="'+(colNames[x]+0)+'" value="'+f+'">'+k+"</select>"}else V+="<input "+g+' type="text" class="tem Family form-control fldtableinput" name="'+colNames[x]+'" id="'+(colNames[x]+0)+'" value="'+l+'">';parent.ChangedTblFieldVals[x]=0==x?l:parent.ChangedTblFieldVals[x]+"~"+l,V+='</div><div class="clearfix"></div>'};for(x=0;x<u;x++){var k,O;R()}e="<div>",e+=V+="</div>",e+='</div><div class="clearfix"></div>',e+='<div><div class="col-12 float-end"><a href="javascript:void(0)" onclick="ClearTableData(\'fldTable\');" title="Clear" class="btn btn-white btn-color-gray-700 btn-active-primary d-inline-flex align-items-center shadow-sm me-2 '+g+'"><span class="material-icons">clear</span>Clear</a><a href="javascript:void(0);" title="Ok" onclick="AddTableData(\''+a+"','"+b+"','"+h+'\');" class="btn btn-primary d-inline-flex align-items-center shadow-sm me-2 '+g+'"><span class="material-icons">save</span>Ok</a></div></div>'}}}}catch(E){}$("#divTable").html(e)}function AddTableData(e,a,t){var l="";if($("#fldTable tbody tr").length>0)$("#fldTable tbody tr").each(function(){var e="";$(this).find("td").each(function(){$(this).find("select").length>0&&void 0!==$(this).find("select").attr("value")?e+=$(this).find("select").attr("value")+a:$(this).find("input:text").length>0&&(e+=$(this).find("input").attr("value")+a)}),""!=e&&(e=e.substring(0,e.length-1)),l+=e+t});else{var n="";$("#divTable").find("input,select").each(function(){$(this).is("select")&&void 0!==$(this).attr("value")?n+=$(this).attr("value")+a:$(this).is("input")&&"text"==$(this).attr("type")&&(n+=$(this).attr("value")+a)}),""!=n&&(n=n.substring(0,n.length-1)),l+=n+t}l=l.substring(0,l.length-1),$j("#"+e,doParentOpInIframe("document","rtn","#"+e)).val(l),UpdateArray(e,l),callParentNew("modalIdTableField","id").dispatchEvent(new CustomEvent("close"))}function ClearTableData(e){$("#"+e+" tbody tr td").each(function(){$(this).find("input:text").val(""),$(this).find("input:text").attr("value",""),$(this).find("select").val(""),$(this).find("select").prop("selected",!1)})}function DeleteTableRows(e){$("#"+e+" tbody tr").each(function(){void 0!==$(this).find(".fgChk:checked").prop("checked")&&$(this).find(".fgChk:checked").prop("checked")&&$(this).remove()})}function AddTableRows(e){var a=$("#"+e+" tbody tr:last"),t=$("#"+e+" tbody tr:last").attr("id");$(a).clone().insertAfter(a).find("input:text").val(""),$("#"+e+" tbody tr:last").find("select,input,div.autoclear i,div.edit i,div[id^=autoadv],div[id^=autoadv] i").each(function(e,a){var l=$j(this);if(id=l.attr("data-clk"),id!=undefined)l.attr("data-clk",$j(this).parents(".autoinput-parent").find("input").attr("id"));else{var n=l.attr("name"),r=n+(parseInt(t)+1);l.attr("id",r)}}),$("#"+e+" tbody tr:last").attr("id",(parseInt(t)+1).toString()),LoadTableEvents("#divTable")}function MainBlur(obj,type){var fldInd=colNames.indexOf(obj.attr("name"));if("undefined"!=typeof colVExp[fldInd]&&""!=colVExp[fldInd]){var vExp=colVExp[fldInd].replace(/,/g,"♦"),vRowNo=obj.attr("id").replace(obj.attr("name"),""),indx=$j.inArray(obj.attr("name"),parent.ChangedTblFields),cellVal=parent.ChangedTblFieldVals[indx].split("~");cellVal[vRowNo]=$(obj).val(),parent.ChangedTblFieldVals[indx]=cellVal.join("~");var fResult=callParentNew("Evaluate("+obj.attr("name")+","+vRowNo+","+vExp+",vexpr,table)","function");if("T"!=fResult&&"t"!=fResult&&1!=fResult){var cutMsg=eval(callParent("lcm[52]")),firstChar=fResult.substring(0,1),alertMsg=fResult.substring(1);if("_"!=firstChar){if("?"==firstChar){if(showAlertDialog("error",alertMsg),"input"==type)$(obj).val($(obj).val()),$(obj).attr("value",$(obj).val());else{var ddlValue=$j(obj).val();$j(obj).attr("selected","selected"),$(obj).attr("value",ddlValue)}return!1}if("*"==firstChar)return showAlertDialog("error",alertMsg),!1;if("MessageSetAxFont"==fResult)return!0;if(confirm(fResult+". "+cutMsg)){if("input"==type)$(obj).val($(obj).val()),$(obj).attr("value",$(obj).val());else{var _ddlValue=$j(obj).val();$j(obj).attr("selected","selected"),$(obj).attr("value",_ddlValue)}return!1}return!0}showAlertDialog("error",alertMsg)}TableEvalonBlur(indx,vRowNo)}else{if("input"==type)$(obj).val($(obj).val()),$(obj).attr("value",$(obj).val());else{var _ddlValue2=$j(obj).val();$j(obj).attr("selected","selected"),$(obj).attr("value",_ddlValue2)}var vRowNo=obj.attr("id").replace(obj.attr("name"),""),indx=$j.inArray(obj.attr("name"),parent.ChangedTblFields),cellVal=parent.ChangedTblFieldVals[indx].split("~");cellVal[vRowNo]=$(obj).val(),parent.ChangedTblFieldVals[indx]=cellVal.join("~"),TableEvalonBlur(indx,vRowNo)}Aportion(obj)}function TableEvalonBlur(e,a){if("undefined"!=typeof colfExp[e]&&""==colfExp[e])for(var t=e;t<colfExp.length;t++)if("undefined"!=typeof colfExp[t]&&""!=colfExp[t]){var l=colfExp[t].replace(/,/g,"♦"),n=$("#"+colNames[t]+a),r=$j.inArray(n.attr("name"),parent.ChangedTblFields),s=parent.ChangedTblFieldVals[r].split("~");s[a]=$(n).val(),parent.ChangedTblFieldVals[r]=s.join("~");var i=callParentNew("Evaluate("+n.attr("name")+","+a+","+l+",expr,table)","function");if(""!=i){if("text"==$(n).attr("type"))$(n).val(i),$(n).attr("value",i);else{var o=i;$j(n).attr("selected","selected"),$(n).attr("value",o)}s[a]=i,parent.ChangedTblFieldVals[r]=s.join("~")}}}function UpdateArray(e,a){for(var t=!1,l=0;l<doParentOpInIframe("ChangedFields","rtn").length;l++){if(doParentOpInIframe("ChangedFields["+l+"]","rtn").toString()==e){"***"==a?(doParentOpInIframe("ChangedFields","rtn").splice(l,1),doParentOpInIframe("ChangedFieldDbRowNo","rtn").splice(l,1),doParentOpInIframe("ChangedFieldValues","rtn").splice(l,1),doParentOpInIframe().ChangedFieldOldValues.splice(l,1)):(doParentOpInIframe("ChangedFieldOldValues["+l+"]","var",doParentOpInIframe("ChangedFieldValues["+l+"]","rtn").toString()),doParentOpInIframe("ChangedFieldDbRowNo["+l+"]","var",doParentOpInIframe("ChangedFieldDbRowNo["+l+"]","rtn")),doParentOpInIframe("ChangedFieldValues["+l+"]","var",a)),t=!0;break}}if(!t&&"***"!=a){var n=e.lastIndexOf("F"),r=e.substring(n-3,n),s=e.substring(n+1),i=callParentNew("GetDbRowNo("+r+","+s+")","function");parent.ChangedFields.push(e),parent.ChangedFieldDbRowNo.push(i),parent.ChangedFieldValues.push(a),parent.ChangedFieldOldValues.push("")}}function CheckSpecialCharsInStr(e){return e=(e=e)!=undefined?(e=(e=(e=(e=e.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&apos;")).replace(/"/g,"&quot;"):""}function RepSpecialCharsInHTML(e){return e=(e=(e=(e=(e=e.replace(/&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&apos;/g,"'")).replace(/&quot;/g,'"')}function CheckAll(e){$j("input[name=chkItem]:checkbox").each(function(){$j(this).prop("checked",e.checked)})}function ChkHdrCheckbox(e,a){$j(".fgChk:visible").length==$j(".fgChk:checked").length?$j(".fgHdrChk").prop("checked",!0):$j(".fgHdrChk").prop("checked",!1)}function GetTblFldAutoData(thisId,thisFldId){fldAutoData=[];var custData=callParentNew("AxGetCustSelectFldData("+thisFldId+")","function");if(""!=custData){fldAutoList=thisFldId;var JsonData=JSON.parse(custData),fldData=JsonData.pickdata[3].data,aSearch=[];if($(fldData).each(function(e,a){a.i=a.i.replace(/\^\^dq/g,'"'),aSearch.push(a)}),0!=aSearch.length){var result=$.map(aSearch,function(e){return e.i=e.i.replace(/\^\^dq/g,'"'),{id:""==e.v?e.i:e.v,text:e.i}});fldAutoData=result}else{var cutMsg=eval(callParent("lcm[0]"));fldAutoData={results:"",noResults:cutMsg}}}}function Aportion(e){colNames.indexOf(e.attr("name"));var a=e.attr("name"),t=aportionAgainst.indexOf(a);if(t>-1){var l=colNames[t],n=0;$('[name="'+l+'"]').each(function(){n=parseInt(n)+parseInt(""==$(this).val()?0:$(this).val())});var r=$(e).val();if(""!=r){var s=$(e).parents("tr").find("[name='"+l+"']").val(),i=$(e).parents("tr").find("[name='"+l+"']").attr("id");if(parseInt(r)<=parseInt(s)){$($("#"+i)).val(r),$($("#"+i)).attr("value",r);var o=$(e).parents("tr").next("tr").find("[name='"+l+"']").val(),c=$(e).parents("tr").next("tr").find("[name='"+l+"']").attr("id"),d=0;if($('[name="'+l+'"]').each(function(){d=parseInt(d)+parseInt(""==$(this).val()?0:$(this).val())}),""==o&&parseInt(aportionWhatVal[t])>parseInt(r)){var p=0;p=aportionWhatVal[t]==n?aportionWhatVal[t]-parseInt(d):aportionWhatVal[t]-(n+parseInt(r)),$($("#"+c)).val(p),$($("#"+c)).attr("value",p)}else if(""!=o&&parseInt(aportionWhatVal[t])>parseInt(n));}else if(""!=s&&"0"!=s||parseInt(aportionWhatVal[t])==parseInt(n)){if(""!=s&&""==aportionWhatVal[t])$($("#"+i)).val(r),$($("#"+i)).attr("value",r);else if(parseInt(aportionWhatVal[t])!=parseInt(n)){var u=parseInt(aportionWhatVal[t])-parseInt(n),f=$(e).parents("tr").find("[name='"+l+"']").val();r>=(u+=parseInt(f))?($($("#"+i)).val(u),$($("#"+i)).attr("value",u)):($($("#"+i)).val(r),$($("#"+i)).attr("value",r))}}else $($("#"+i)).val(r),$($("#"+i)).attr("value",r)}}}function SqlFillData(){if(""!=sqlQuery){var e="";try{$.ajax({url:"tsttable.aspx/GetSqlFillData",type:"POST",cache:!1,async:!0,data:JSON.stringify({strSql:sqlQuery}),dataType:"json",contentType:"application/json",success:function(a){if(""!=a.d){e=JSON.parse(a.d);for(var t=0;t<e.length;t++){var l=e[t];for(var n in l)for(var r in l[n]){var s=r,i=$($("#"+s+t));0==i.length&&(AddTableRows("fldTable"),i=$($("#"+s+t)));var o=l[n][r];if("text"==$(i).attr("type"))$(i).val(o),$(i).attr("value",o);else{var c=o;$(i).attr("selected","selected"),$(i).attr("value",c)}}}}else e=""},error:function(a){e=""}})}catch(a){}}}function GetstrTableJson(e){var a="";try{$.ajax({url:"tsttable.aspx/GetstrTableJson",type:"POST",cache:!1,async:!1,data:JSON.stringify({descrName:e}),dataType:"json",contentType:"application/json",success:function(e){if(""!=e.d){var t=JSON.parse(e.d);""!=t&&(a=getCaseInSensitiveJsonProperty(t[0].row,"tjson"))}else a=""},error:function(e){a=""}})}catch(t){}return a}function GetAutoCompData(e,a,t,l){var n="";if(arrRefreshDcs.length>0)for(var r=0;r<arrRefreshDcs.length;r++){var s=arrRefreshDcs[r].split(":");n=s[1].replace("dc","")+","+s[0].replace("dc","")}a=CheckSpecialCharsInStr(a);var i=callParentNew("GetFieldsDcNo("+e+")","function");AxActiveRowNo=parseInt(callParentNew("GetFieldsRowNo("+e+")","function"),10),AxActiveRowNo=callParentNew("GetDbRowNo("+AxActiveRowNo+","+i+")","function");var o=AxActiveRowNo,c="";""!=AxActivePRow&&""!=AxActivePDc&&(c=AxActivePDc+"♠"+AxActivePRow);return t.toString()+"~"+l.toString()+"~"+i+"~"+o+"~"+c+"~~"+n}